<!DOCTYPE html>
<html style="font-size: 32px;">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
	<title>总书记两会高频词</title>
	<script>
		document.addEventListener("touchmove",function(e){e.preventDefault();})
	</script>
	<style>
	.fly-loading-C{position:absolute;left:0;top:0;width:100%;height:100%;
            background:url(./assets/images/bg.jpg) no-repeat center center;
            background-size:cover;
         
        }
		.l-loading-scale{
        position:absolute;top:50%;
        color:#fff;
        width:100%;
        font-size:20px;
        font-family:Georgia;
        text-align:center;
        margin-top:1.5rem;
        
    }
    .fly-loading-canvas{
        position: absolute;;
           left:50%;
            top:50%;
            transform: translate(-50%,-50%);
            -webkit-transform: translate(-50%,-50%);
            overflow: hidden;
    }
	</style>
</head>
<body style="overflow: hidden;">
		<div style="opacity: 0;position: fixed;left: 600px;"><img src="./assets/images/300.jpg"></div>
		<div id="fly-main">
			<div class="fly-loading-C">
			    <div class="fly-loading-canvas">
			        <img src='./assets/images/logo.png' width="69" height="69" />
			        <canvas id="loading"></canvas>
			    </div>
			    <div class='l-loading-scale' id='l-loading-scale'></div>
			    <canvas id='canvas'></canvas>
			</div>
		</div>
		<!-- 
			<script src='http://localhost:4600/index.js'></script> 
		-->

		<script src='http://res.wx.qq.com/open/js/jweixin-1.2.0.js'></script>

		<script type="text/javascript">
			
			 !function(document){

		        var size = setSize();

		         var canvas = document.getElementById ( 'loading' ),
		            context = canvas.getContext ( '2d' );

		        canvas.parentNode.style.width = canvas.width + "px";
		        canvas.parentNode.style.height = canvas.height + "px";
		        context.fillStyle = 'rgba(0,0,0,.5)';
		        context.fillRect ( 0, 0, canvas.width, canvas.height );
		        var x = canvas.width >> 1,
		                y = canvas.height >> 1,
		                r = canvas.width >> 1;

		        context.globalCompositeOperation = 'destination-out';
		        context.beginPath ();
		        var ang = - 90;
		        context.fillStyle = '#000';


		         var arr = [
		           		"./assets/images/300.jpg",
						 "./assets/images/bg.jpg",
						 "./assets/images/chuangxin.png",
						 "./assets/images/chuangxin1.jpg",
						 "./assets/images/chuangxin2.jpg",
						 "./assets/images/chuangxin3.jpg",
						 "./assets/images/chuangxin4.jpg",
						 "./assets/images/chuangxin5.jpg",
						 "./assets/images/circle.png",
						 "./assets/images/cxtext.png",
						 "./assets/images/end.jpg",
						 "./assets/images/fazhan.png",
						 "./assets/images/fazhan1.jpg",
						 "./assets/images/fazhan2.jpg",
						 "./assets/images/fazhan3.jpg",
						 "./assets/images/fazhan4.jpg",
						 "./assets/images/fptext.png",
						 "./assets/images/fupin.png",
						 "./assets/images/fupin1.jpg",
						 "./assets/images/fupin2.jpg",
						 "./assets/images/fupin3.jpg",
						 "./assets/images/fupin4.jpg",
						 "./assets/images/fupin5.jpg",
						 "./assets/images/fztext.png",
						 "./assets/images/gaige.png",
						 "./assets/images/gaige1.jpg",
						 "./assets/images/gaige2.jpg",
						 "./assets/images/gaige3.jpg",
						 "./assets/images/gaige4.jpg",
						 "./assets/images/ggtext.png",
						 "./assets/images/gpc.png",
						 "./assets/images/index-bg.jpg",
						 "./assets/images/kaifang.png",
						 "./assets/images/kaifang1.jpg",
						 "./assets/images/kaifang2.jpg",
						 "./assets/images/kaifang3.jpg",
						 "./assets/images/kaifang4.jpg",
						 "./assets/images/kftext.png",
						 "./assets/images/mask-bg.jpg",
						 "./assets/images/result.png",
						 "./assets/images/shengtai.png",
						 "./assets/images/shengtai1.jpg",
						 "./assets/images/shengtai2.jpg",
						 "./assets/images/sttext.png",
						 "./assets/images/yulu.png"
		        ];

		        var scale = document.getElementById('l-loading-scale');

		        loading(arr,function(data){
		            scale.innerHTML = ((data*100 | 0)>99 ? 99 : (data*100 | 0))+'%';
		             context.moveTo ( x, y );
		            context.arc ( x, y, r - 5, - .5 * Math.PI, (data*2 -.5)* Math.PI , false );
		            context.closePath ();
		            context.fill ();
		        },function(){

		            var timer = setInterval(function(){

		                 r+=1.5;
		                if(r>=(canvas.width+canvas.height)/2){
		                    clearInterval(timer);
		                    var s = document.createElement('script');
		                    document.body.appendChild(s);
		                    s.onload = function(){
		                        scale.innerHTML = '100%';
		                    //document.querySelector('.fly-loading-C').classList.add('hide');
		                    }
		                    
		                     /*var src = 'http://localhost:3000/index.js';
		                    if(window.location.href.indexOf('192.168.2.109')<=-1 || window.location.href.indexOf('http://localhost:8080')<=-1){
		                        src = './assets/js/index.js?t='+new Date().getTime();
		                    }*/
		                    src = './assets/js/index.js?t='+new Date().getTime();
		                    //src='http://localhost:4500/index.js'
		                    s.src= src;
		                }
		                context.arc ( x, y, r, - .5 * Math.PI, 1.5 * Math.PI , false );
		                context.closePath ();
		                context.fill ();    
		            },20);
		            

		           
		        });

		     function  loading(arr, fn, fnEnd){
		        var len = arr.length;
		        var count = 0;
		        var i = 0;
		        
		        function loadimg() {
		            if (i === len) {
		                return;
		            }
		            var img = new Image();
		            img.onload = img.onerror = function(){
		                count++;
		                if (i < len - 1) {
		                    i++;
		                    loadimg();
		                    fn && fn(i / (len - 1), img.src);
		                } else {
		                    fnEnd && fnEnd(img.src);
		                }
		            };
		            img.src = arr[i];
		        }
		       loadimg();
		    }

		    function setSize(){
		        var viewWidth = document.documentElement.clientWidth,
		            viewHeight = document.documentElement.clientHeight;
		            var canvas = document.getElementById('loading');
		            var canvas1=document.getElementById('canvas');
		            canvas1.width = document.documentElement.clientWidth;
		        canvas.width =69;// viewWidth;
		        canvas.height =69;// viewHeight;
		        return{viewWidth:canvas.width,viewHeight:canvas.height};
		    }
		 }(document);
		</script>
		<script>
				
				function onError(){

						var script = '<script src="./assets/js/index.js"><\/script> ';
						var s = document.createElement('script');
						s.src='./assets/js/index.js';
						document.body.appendChild(s);;
				}

		</script>
		<!-- <script src='http://localhost:4600/index.js' onError='onError()'></script>  -->
</body>
</html>